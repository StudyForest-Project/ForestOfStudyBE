components:
  schemas:
    ErrorResponse:
      type: object
      properties:
        error:
          type: object
          properties:
            status:
              type: integer
              example: 400
            code:
              type: string
              example: NOT_FOUND
            message:
              type: string
              example: ìŠ¤í„°ë”” ë¦¬ìŠ¤íŠ¸ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤

    StudyDetailResponse:
      type: object
      properties:
        study:
          type: object
          properties:
            id:
              type: string
              example: 01KFZ1K63J37VSVNBYC61TJ54V
            title:
              type: string
              example: ì—°ìš°ì˜ ê°œë°œê³µì¥
            nickname:
              type: string
              example: J
            description:
              type: string
              example: í•¨ê»˜ ì„±ì¥í•˜ëŠ” ìŠ¤í„°ë””ì…ë‹ˆë‹¤
            backgroundImage:
              type: string
              example: https://.../bg1.png
            totalPoint:
              type: integer
              example: 310
            createdAt:
              type: string
              format: date-time
            updatedAt:
              type: string
              format: date-time
        emojis:
          type: array
          items:
            type: object
            properties:
              emoji:
                type: string
                example: ğŸ”¥
              count:
                type: integer
                example: 12
        habitWeek:
          type: object
          properties:
            rows:
              type: array
              items:
                type: object
                properties:
                  habitId:
                    type: string
                    example: 01HAAB...
                  title:
                    type: string
                    example: ìš´ë™í•˜ê¸°
                  checks:
                    type: array
                    items:
                      type: boolean
                    example: [true, false, true, true, false, false, false]
                    description: ì›”~ì¼ ê° ë‚ ì§œì˜ ì™„ë£Œ ì—¬ë¶€

    StudyListResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        items:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
                example: 01HAAA...
              title:
                type: string
                example: ì—°ìš°ì˜ ê°œë°œê³µì¥
              nickname:
                type: string
                example: J
              description:
                type: string
                example: í•¨ê»˜ ì„±ì¥í•˜ëŠ” ìŠ¤í„°ë””ì…ë‹ˆë‹¤
              backgroundImage:
                type: string
                example: https://.../bg1.png
              totalPoint:
                type: integer
                example: 310
              createdAt:
                type: string
                format: date-time
              emojis:
                type: array
                items:
                  type: object
                  properties:
                    emoji:
                      type: string
                      example: ğŸ”¥
                    count:
                      type: integer
                      example: 12
        pageInfo:
          type: object
          properties:
            pageSize:
              type: integer
              example: 6
            nextCursor:
              type: string
              nullable: true
              example: 01HAAB...

    # ìŠ¤í„°ë”” ìƒì„± ì‘ë‹µ
    StudyCreateResponse:
      type: object
      properties:
        study:
          type: object
          properties:
            id:
              type: string
              example: 01KFZ1K63J37VSVNBYC61TJ54V
            title:
              type: string
              example: ì—°ìš°ì˜ ê°œë°œê³µì¥
            nickname:
              type: string
              example: J
            description:
              type: string
              example: í•¨ê»˜ ì„±ì¥í•˜ëŠ” ìŠ¤í„°ë””ì…ë‹ˆë‹¤
            backgroundImage:
              type: string
              example: https://.../bg1.png
            password:
              type: string
              example: $2b$10$...
            totalPoint:
              type: integer
              example: 0
            createdAt:
              type: string
              format: date-time
            updatedAt:
              type: string
              format: date-time

    # Validation ì—ëŸ¬ ì‘ë‹µ
    ValidationErrorResponse:
      type: object
      properties:
        error:
          type: object
          properties:
            code:
              type: string
              example: VALIDATION_ERROR
            fields:
              type: object
              additionalProperties:
                type: string
              example:
                title: ìŠ¤í„°ë”” ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.
                password: ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.

paths:
  /studies:
    post:
      summary: ìŠ¤í„°ë”” ìƒì„±
      tags: [Studies]
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - nickname
                - title
                - description
                - backgroundImage
                - password
              properties:
                nickname:
                  type: string
                  example: J
                  description: ë‹‰ë„¤ì„
                title:
                  type: string
                  example: ì—°ìš°ì˜ ê°œë°œê³µì¥
                  description: ìŠ¤í„°ë”” ì´ë¦„
                description:
                  type: string
                  example: í•¨ê»˜ ì„±ì¥í•˜ëŠ” ìŠ¤í„°ë””ì…ë‹ˆë‹¤
                  description: ìŠ¤í„°ë”” ì†Œê°œ
                backgroundImage:
                  type: string
                  example: https://.../bg1.png
                  description: ë°°ê²½ ì´ë¯¸ì§€ URL
                password:
                  type: string
                  example: mypassword123
                  description: ë¹„ë°€ë²ˆí˜¸
      responses:
        201:
          description: ìŠ¤í„°ë”” ìƒì„± ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StudyCreateResponse'
        400:
          description: ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
              example:
                error:
                  code: VALIDATION_ERROR
                  fields:
                    title: ìŠ¤í„°ë”” ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.
                    password: ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.

    get:
      summary: ìŠ¤í„°ë”” ëª©ë¡ ì¡°íšŒ
      tags: [Studies]
      security: []
      parameters:
        - in: query
          name: pageSize
          schema:
            type: integer
            default: 6
          description: í˜ì´ì§€ í¬ê¸°
        - in: query
          name: search
          schema:
            type: string
          description: ê²€ìƒ‰ì–´ (ì œëª©, ì„¤ëª…ì—ì„œ ê²€ìƒ‰)
        - in: query
          name: sort
          schema:
            type: string
            enum: [recent, oldest, mostPoints, leastPoints]
            default: recent
          description: ì •ë ¬ ê¸°ì¤€
        - in: query
          name: cursor
          schema:
            type: string
          description: ì»¤ì„œ (í˜ì´ì§€ë„¤ì´ì…˜)
      responses:
        200:
          description: ìŠ¤í„°ë”” ëª©ë¡ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StudyListResponse'
        400:
          description: ìœ íš¨í•˜ì§€ ì•Šì€ cursor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                error:
                  status: 400
                  code: BAD_REQUEST
                  message: ìœ íš¨í•˜ì§€ ì•Šì€ cursorì…ë‹ˆë‹¤
        404:
          description: ìŠ¤í„°ë”” ë¦¬ìŠ¤íŠ¸ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                error:
                  status: 404
                  code: NOT_FOUND
                  message: ìŠ¤í„°ë”” ë¦¬ìŠ¤íŠ¸ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

  /studies/{studyId}/emojis:
    post:
      summary: ìŠ¤í„°ë”” ì‘ì› ì´ëª¨ì§€ ë“±ë¡
      tags: [Studies]
      security: []
      parameters:
        - in: path
          name: studyId
          required: true
          schema:
            type: string
            pattern: '^[0-9A-Z]{26}$'
          description: ìŠ¤í„°ë”” ID (ULID í˜•ì‹, 26ì)
          example: 01KFZ1K63J37VSVNBYC61TJ54V
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - emojis
              properties:
                emojis:
                  type: array
                  items:
                    type: string
                  example: ["ğŸ”¥", "ğŸ‘", "ğŸŒ±"]
                  description: ë“±ë¡í•  ì´ëª¨ì§€ ë°°ì—´
      responses:
        201:
          description: ì´ëª¨ì§€ ë“±ë¡ ì„±ê³µ
          content:
            application/json:
              schema:
                type: object
                properties:
                  emojis:
                    type: array
                    items:
                      type: object
                      properties:
                        emoji:
                          type: string
                          example: ğŸ”¥
                        count:
                          type: integer
                          example: 13
              example:
                emojis:
                  - emoji: ğŸ”¥
                    count: 13
                  - emoji: ğŸ‘
                    count: 7
                  - emoji: ğŸŒ±
                    count: 3
        400:
          description: ì˜ëª»ëœ ìš”ì²­
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                invalidId:
                  summary: ì˜ëª»ëœ ID í˜•ì‹
                  value:
                    error:
                      status: 400
                      code: BAD_REQUEST
                      message: ì˜ëª»ëœ ID í˜•ì‹ì…ë‹ˆë‹¤
                emptyEmojis:
                  summary: ì´ëª¨ì§€ ë¯¸ì…ë ¥
                  value:
                    error:
                      status: 400
                      code: BAD_REQUEST
                      message: ì´ëª¨ì§€ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.
        404:
          description: ìŠ¤í„°ë””ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                error:
                  status: 404
                  code: NOT_FOUND
                  message: ìŠ¤í„°ë””ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

  /studies/{id}:
    get:
      summary: ìŠ¤í„°ë”” ìƒì„¸ ì¡°íšŒ
      tags: [Studies]
      security: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            pattern: '^[0-9A-Z]{26}$'
          description: ìŠ¤í„°ë”” ID (ULID í˜•ì‹, 26ì)
          example: 01KFZ1K63J37VSVNBYC61TJ54V
      responses:
        200:
          description: ìŠ¤í„°ë”” ìƒì„¸ ì¡°íšŒ ì„±ê³µ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StudyDetailResponse'
        400:
          description: ì˜ëª»ëœ ID í˜•ì‹ì…ë‹ˆë‹¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                error:
                  status: 400
                  code: BAD_REQUEST
                  message: ì˜ëª»ëœ ID í˜•ì‹ì…ë‹ˆë‹¤
        404:
          description: ìŠ¤í„°ë”” ìƒì„¸í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                error:
                  status: 404
                  code: NOT_FOUND
                  message: ìŠ¤í„°ë”” ìƒì„¸í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

